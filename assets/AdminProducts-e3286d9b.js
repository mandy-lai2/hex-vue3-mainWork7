import{_ as V,o as r,c as m,a as t,b,v as f,r as h,d as a,e as k,F as M,g as T,n as P,h as C,f as U,t as g}from"./index-d3402c58.js";import{m as x,P as w}from"./PaginationComponent-e29ed224.js";const{VITE_API:A,VITE_PATH:D}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"mandyapi",BASE_URL:"/hex-vue3-mainWork7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},O={data(){return{imgUrl:"圖片連結",inputImg:""}},methods:{imgUpload(s){const e=s.target.files[0],d=new FormData;d.append("file-to-upload",e),this.$http.post(`${A}/api/${D}/admin/upload`,d).then(i=>{alert(`${i.data.success?"圖片上傳成功":"失敗"}`),this.imgUrl=i.data.imageUrl,this.inputImg=""}).catch(i=>{console.log(i.response.data.message)})}}},S={class:"container"},R=t("h4",null,"圖片上傳",-1),H={class:"mb-3"},L=["value"],B={class:"mb-5"},q=t("h6",null,"圖片連結👇",-1);function F(s,e,d,i,o,n){return r(),m("div",S,[R,t("div",H,[t("input",{class:"form-control",type:"file",id:"formFile",onChange:e[0]||(e[0]=(...c)=>n.imgUpload&&n.imgUpload(...c)),value:o.inputImg},null,40,L)]),t("div",B,[q,b(t("textarea",{class:"form-control",rows:"3","onUpdate:modelValue":e[1]||(e[1]=c=>o.imgUrl=c)},null,512),[[f,o.imgUrl]])])])}const G=V(O,[["render",F]]),{VITE_API:$,VITE_PATH:E}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"mandyapi",BASE_URL:"/hex-vue3-mainWork7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},W={props:{product:{type:Object,default(){return{}}}},data(){return{tempProduct:{},modal:""}},components:{ImgUpload:G},mixins:[x],watch:{product(){this.tempProduct=this.product}},methods:{updateProduct(s){let e="",d="";s==="new"?(e=`${$}/api/${E}/admin/product`,d="post"):s==="edit"&&(e=`${$}/api/${E}/admin/product/${this.tempProduct.id}`,d="put"),this.$http[d](e,{data:this.tempProduct}).then(i=>{alert(i.data.message),this.$emit("getProducts"),this.$emit("closeModal","modal")}).catch(i=>{alert(i.response.data.message)})},addImage(){this.tempProduct.imagesUrl?this.tempProduct.imagesUrl.push(""):this.tempProduct.imagesUrl=[""]},removeImage(s){this.tempProduct.imagesUrl.splice(s,1)}}},N={class:"modal fade",id:"modal",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true",ref:"modal"},j={class:"modal-dialog modal-xl"},z={class:"modal-content"},J={class:"modal-header"},K={class:"modal-title",id:"modalLabel"},Q={key:0},X={key:1},Y=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Z={class:"modal-body"},tt={class:"col-md-4"},et=t("label",{for:"mainImage",class:"form-label"},"主要圖片",-1),ot=["src"],st=t("h3",{class:"mt-5"},"多圖新增",-1),lt=t("label",{for:"imageUrl",class:"form-label mt-3"},"圖片網址",-1),dt=["onUpdate:modelValue"],nt=["src"],it=["onClick"],at={class:"col-md-8"},ct={class:"row"},rt={class:"col-12 mb-3"},mt=t("label",{for:"inputTitle",class:"form-label"},"標題",-1),ut={class:"col-md-6 mb-3"},pt=t("label",{for:"inputCategory",class:"form-label"},"分類",-1),_t={class:"col-md-6"},ht=t("label",{for:"inputUnit",class:"form-label"},"單位",-1),bt={class:"col-md-6 mb-3"},Pt=t("label",{for:"inputOriginPrice",class:"form-label"},"原價",-1),ft={class:"col-md-6"},gt=t("label",{for:"inputPrice",class:"form-label"},"售價",-1),vt=t("hr",{class:"mt-3"},null,-1),Vt={class:"col-12 mb-3"},yt=t("label",{for:"description",class:"form-label"},"產品描述",-1),Mt={class:"col-12 mb-3"},It=t("label",{for:"productContent",class:"form-label"},"說明內容",-1),Ut={class:"col-12 mb-3"},$t=t("label",{class:"form-check-label",for:"isEnabled"}," 是否啟用 ",-1),Et=t("div",{class:"text-success"},[t("hr")],-1),Tt={class:"modal-footer"},xt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function kt(s,e,d,i,o,n){const c=h("v-field"),_=h("error-message"),y=h("v-form"),u=h("ImgUpload");return r(),m("div",N,[t("div",j,[t("div",z,[t("div",J,[t("h5",K,[o.tempProduct.id?(r(),m("span",Q,"編輯產品")):(r(),m("span",X,"新增產品"))]),Y]),t("div",Z,[a(y,{class:"row g-3 mb-3"},{default:k(({errors:p})=>[t("div",tt,[et,b(t("input",{type:"text",class:"form-control",id:"mainImage",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=l=>o.tempProduct.imageUrl=l)},null,512),[[f,o.tempProduct.imageUrl]]),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl,alt:"圖片"},null,8,ot),st,(r(!0),m(M,null,T(o.tempProduct.imagesUrl,(l,v)=>(r(),m(M,{key:v},[lt,b(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":I=>o.tempProduct.imagesUrl[v]=I},null,8,dt),[[f,o.tempProduct.imagesUrl[v]]]),t("img",{class:"img-fluid",src:l,alt:"圖片"},null,8,nt),t("button",{type:"button",class:"btn btn-outline-danger w-100 mt-2",onClick:I=>n.removeImage(v)}," 刪除 ",8,it)],64))),128)),t("button",{type:"button",class:"btn btn-outline-primary w-100 mt-3",onClick:e[1]||(e[1]=(...l)=>n.addImage&&n.addImage(...l))}," 新增圖片 ")]),t("div",at,[t("div",ct,[t("div",rt,[mt,a(c,{id:"inputTitle",name:"標題",type:"text",class:P(["form-control",{"is-invalid":p.標題}]),placeholder:"請輸入標題",rules:"required",modelValue:o.tempProduct.title,"onUpdate:modelValue":e[2]||(e[2]=l=>o.tempProduct.title=l)},null,8,["class","modelValue"]),a(_,{name:"標題",class:"invalid-feedback"})]),t("div",ut,[pt,a(c,{id:"inputCategory",name:"分類",type:"text",class:P(["form-control",{"is-invalid":p.分類}]),placeholder:"請輸入分類",rules:"required",modelValue:o.tempProduct.category,"onUpdate:modelValue":e[3]||(e[3]=l=>o.tempProduct.category=l)},null,8,["class","modelValue"]),a(_,{name:"分類",class:"invalid-feedback"})]),t("div",_t,[ht,a(c,{id:"inputUnit",name:"單位",type:"text",class:P(["form-control",{"is-invalid":p.單位}]),placeholder:"請輸入單位",rules:"required",modelValue:o.tempProduct.unit,"onUpdate:modelValue":e[4]||(e[4]=l=>o.tempProduct.unit=l)},null,8,["class","modelValue"]),a(_,{name:"單位",class:"invalid-feedback"})]),t("div",bt,[Pt,a(c,{id:"inputOriginPrice",name:"原價",type:"number",class:P(["form-control",{"is-invalid":p.原價}]),placeholder:"請輸入原價",rules:"required",modelValue:o.tempProduct.origin_price,"onUpdate:modelValue":e[5]||(e[5]=l=>o.tempProduct.origin_price=l),modelModifiers:{number:!0}},null,8,["class","modelValue"]),a(_,{name:"原價",class:"invalid-feedback"})]),t("div",ft,[gt,a(c,{id:"inputPrice",name:"售價",type:"number",class:P(["form-control",{"is-invalid":p.售價}]),placeholder:"請輸入售價",rules:"required",modelValue:o.tempProduct.price,"onUpdate:modelValue":e[6]||(e[6]=l=>o.tempProduct.price=l),modelModifiers:{number:!0}},null,8,["class","modelValue"]),a(_,{name:"售價",class:"invalid-feedback"})]),vt,t("div",Vt,[yt,b(t("textarea",{class:"form-control",id:"description",rows:"3",placeholder:"請輸入產品描述","onUpdate:modelValue":e[7]||(e[7]=l=>o.tempProduct.description=l)},null,512),[[f,o.tempProduct.description]])]),t("div",Mt,[It,b(t("textarea",{class:"form-control",id:"productContent",rows:"3",placeholder:"請輸入說明內容","onUpdate:modelValue":e[8]||(e[8]=l=>o.tempProduct.content=l)},null,512),[[f,o.tempProduct.content]])]),t("div",Ut,[b(t("input",{class:"form-check-input",type:"checkbox",id:"isEnabled","onUpdate:modelValue":e[9]||(e[9]=l=>o.tempProduct.is_enabled=l)},null,512),[[C,o.tempProduct.is_enabled]]),$t])])])]),_:1}),Et,a(u)]),t("div",Tt,[xt,t("button",{type:"button",class:"btn btn-primary",onClick:e[10]||(e[10]=p=>n.updateProduct(o.tempProduct.id?"edit":"new"))}," 確認 ")])])])],512)}const Ct=V(W,[["render",kt]]),{VITE_API:wt,VITE_PATH:At}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"mandyapi",BASE_URL:"/hex-vue3-mainWork7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Dt={props:{tempProduct:{type:Object,default(){return{}}}},mixins:[x],methods:{delProduct(){this.$http.delete(`${wt}/api/${At}/admin/product/${this.tempProduct.id}`).then(s=>{alert(s.data.message),this.$emit("getProducts"),this.$emit("closeModal","delModal")}).catch(s=>{alert(s.response.data.message)})}}},Ot={class:"modal fade",id:"delCheckModal",tabindex:"-1","aria-labelledby":"delCheckModalLabel","aria-hidden":"true",ref:"modal"},St={class:"modal-dialog modal-xl"},Rt={class:"modal-content"},Ht=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"delCheckModalLabel"},"刪除產品"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Lt={class:"modal-body"},Bt={class:"modal-footer"},qt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ft(s,e,d,i,o,n){return r(),m("div",Ot,[t("div",St,[t("div",Rt,[Ht,t("div",Lt,[U(" 是否刪除 "),t("strong",null,g(d.tempProduct.title),1),U(" 商品(刪除後將無法恢復) ")]),t("div",Bt,[qt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...c)=>n.delProduct&&n.delProduct(...c))}," 確認刪除 ")])])])],512)}const Gt=V(Dt,[["render",Ft]]),{VITE_API:Wt,VITE_PATH:Nt}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"mandyapi",BASE_URL:"/hex-vue3-mainWork7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},jt={data(){return{products:[],tempProduct:{},pagination:{}}},components:{ProductModal:Ct,DelProductModal:Gt,PaginationComponent:w},methods:{getProducts(s=1){const e=this.$loading.show();this.$http.get(`${Wt}/api/${Nt}/admin/products?page=${s}`).then(d=>{const{pagination:i,products:o}=d.data;this.products=o,this.pagination=i,e.hide()}).catch(d=>{alert(d.response.data.message)})},OpenModal(s,e){const d=this.$refs.productModal,i=this.$refs.delProductModal;s==="new"?(this.tempProduct={imagesUrl:[]},d.openModal()):s==="edit"?(this.tempProduct={...e},d.openModal()):s==="del"&&(this.tempProduct={...e},i.openModal())},closeModal(s){const e=this.$refs.productModal,d=this.$refs.delProductModal;s==="modal"?e.hideModal():s==="delModal"&&d.hideModal()}},mounted(){this.getProducts()}},zt={class:"container"},Jt={class:"row py-3"},Kt={class:"col-12"},Qt=t("h2",null,"產品列表",-1),Xt={class:"table table-hover mt-5"},Yt=t("thead",null,[t("tr",null,[t("th",{width:"100"},"分類"),t("th",{width:"150"},"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Zt={width:"100"},te={width:"150"},ee={width:"120"},oe={width:"120"},se={width:"100"},le={key:0,class:"text-success"},de={key:1},ne={width:"120"},ie=["onClick"],ae=["onClick"];function ce(s,e,d,i,o,n){const c=h("PaginationComponent"),_=h("ProductModal"),y=h("DelProductModal");return r(),m("div",zt,[t("div",Jt,[t("div",Kt,[Qt,t("button",{type:"button",class:"btn btn-primary float-end",onClick:e[0]||(e[0]=u=>n.OpenModal("new"))}," 建立新的產品 "),t("table",Xt,[Yt,t("tbody",null,[(r(!0),m(M,null,T(o.products,u=>(r(),m("tr",{key:u.id},[t("td",Zt,g(u.category),1),t("td",te,g(u.title),1),t("td",ee,g(u.origin_price),1),t("td",oe,g(u.price),1),t("td",se,[u.is_enabled?(r(),m("span",le,"啟用")):(r(),m("span",de,"未啟用"))]),t("td",ne,[t("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:p=>n.OpenModal("edit",u)}," 編輯 ",8,ie),t("button",{type:"button",class:"btn btn-outline-danger",onClick:p=>n.OpenModal("del",u)}," 刪除 ",8,ae)])]))),128))])]),a(c,{pages:o.pagination,onEmitPages:n.getProducts},null,8,["pages","onEmitPages"])]),a(_,{product:o.tempProduct,onGetProducts:n.getProducts,onCloseModal:n.closeModal,ref:"productModal"},null,8,["product","onGetProducts","onCloseModal"]),a(y,{"temp-product":o.tempProduct,onGetProducts:n.getProducts,onCloseModal:n.closeModal,ref:"delProductModal"},null,8,["temp-product","onGetProducts","onCloseModal"])])])}const ue=V(jt,[["render",ce]]);export{ue as default};
