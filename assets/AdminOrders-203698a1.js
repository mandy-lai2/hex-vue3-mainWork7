import{m as y,P as E}from"./PaginationComponent-e29ed224.js";import{_ as $,o as r,c,a as t,t as o,F as p,g as f,b as v,h as k,f as w,r as b,d as O}from"./index-d3402c58.js";const P={methods:{timeDate(e){return new Date(e*1e3).toLocaleDateString()}}},x={props:{order:{type:Object,default(){return{}}}},data(){return{tempOrder:{},modal:""}},watch:{order(){this.tempOrder=this.order}},mixins:[y,P],methods:{}},C={class:"modal fade",id:"modal",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true",ref:"modal"},D={class:"modal-dialog modal-xl"},V={class:"modal-content"},T=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"modalLabel"}," 訂單細節 "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={class:"modal-body"},A={class:"row g-3"},L={class:"col-12"},S=t("h3",null,"用戶資料",-1),U={class:"table"},R=t("th",{scope:"row",width:"80"},"姓名",-1),B=t("th",{scope:"row",width:"80"},"Email",-1),H=t("th",{scope:"row",width:"80"},"電話",-1),N=t("th",{scope:"row",width:"80"},"地址",-1),j=t("h3",null,"訂單細節",-1),q={class:"table"},F=t("th",{scope:"row",width:"80"},"訂單編號",-1),G=t("th",{scope:"row",width:"80"},"下單時間",-1),W=t("th",{scope:"row",width:"80"},"付款時間",-1),z=t("th",{scope:"row",width:"80"},"付款狀態",-1),J=t("th",{scope:"row",width:"80"},"總金額",-1),K=t("h3",null,"選購商品",-1),Q={class:"table"},X={scope:"row"},Y={class:"form-check form-switch"},Z={class:"form-check-label",for:"checkPaid"},tt={class:"modal-footer"},et=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function st(e,d,n,h,s,i){var _,m,u,a;return r(),c("div",C,[t("div",D,[t("div",V,[T,t("div",I,[t("div",A,[t("div",L,[S,t("table",U,[t("tbody",null,[t("tr",null,[R,t("td",null,o((_=s.tempOrder.user)==null?void 0:_.name),1)]),t("tr",null,[B,t("td",null,o((m=s.tempOrder.user)==null?void 0:m.email),1)]),t("tr",null,[H,t("td",null,o((u=s.tempOrder.user)==null?void 0:u.tel),1)]),t("tr",null,[N,t("td",null,o((a=s.tempOrder.user)==null?void 0:a.address),1)])])])]),j,t("table",q,[t("tbody",null,[t("tr",null,[F,t("td",null,o(s.tempOrder.id),1)]),t("tr",null,[G,t("td",null,o(e.timeDate(s.tempOrder.create_at)),1)]),t("tr",null,[W,t("td",null,o(e.timeDate(s.tempOrder.paid_date)),1)]),t("tr",null,[z,t("td",null,o(s.tempOrder.is_paid===!0?"已付款":"未付款"),1)]),t("tr",null,[J,t("td",null,o(s.tempOrder.total),1)])])]),K,t("table",Q,[t("tbody",null,[(r(!0),c(p,null,f(s.tempOrder.products,l=>(r(),c("tr",{key:l.id},[t("th",X,o(l.product.title),1),t("td",null,o(l.qty)+" "+o(l.product.unit),1),t("td",null,o(l.final_total),1)]))),128)),t("tr",null,[t("td",null,[t("div",Y,[v(t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"checkPaid","onUpdate:modelValue":d[0]||(d[0]=l=>s.tempOrder.is_paid=l)},null,512),[[k,s.tempOrder.is_paid]]),t("label",Z,o(s.tempOrder.is_paid===!0?"已付款":"未付款"),1)])])])])])])]),t("div",tt,[et,t("button",{type:"button",class:"btn btn-primary",onClick:d[1]||(d[1]=l=>e.$emit("updatePaid",s.tempOrder))}," 確認修改 ")])])])],512)}const ot=$(x,[["render",st]]),{VITE_API:dt,VITE_PATH:lt}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"mandyapi",BASE_URL:"/hex-vue3-mainWork7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},at={props:{order:{type:Object,default(){return{}}}},mixins:[y],methods:{delOrder(){this.$http.delete(`${dt}/api/${lt}/admin/order/${this.order.id}`).then(e=>{alert(e.data.message),this.$emit("getOrders"),this.$emit("closeModal","delModal")}).catch(e=>{alert(e.response.data.message)})}}},nt={class:"modal fade",id:"delCheckModal",tabindex:"-1","aria-labelledby":"delCheckModalLabel","aria-hidden":"true",ref:"modal"},it={class:"modal-dialog modal-xl"},rt={class:"modal-content"},ct=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"delCheckModalLabel"},"刪除訂單"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ht={class:"modal-body"},_t={class:"text-danger"},mt={class:"modal-footer"},ut=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function pt(e,d,n,h,s,i){return r(),c("div",nt,[t("div",it,[t("div",rt,[ct,t("div",ht,[w(" 是否刪除 "),t("span",_t,o(n.order.id),1),w(" 訂單(刪除後將無法恢復) ")]),t("div",mt,[ut,t("button",{type:"button",class:"btn btn-danger",onClick:d[0]||(d[0]=(..._)=>i.delOrder&&i.delOrder(..._))}," 確認刪除 ")])])])],512)}const bt=$(at,[["render",pt]]),{VITE_API:M,VITE_PATH:g}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"mandyapi",BASE_URL:"/hex-vue3-mainWork7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ot={data(){return{orders:[],pagination:{},tempOrder:{id:"333"}}},components:{OrderModal:ot,DelOrderModal:bt,PaginationComponent:E},mixins:[P],methods:{getOrders(e=1){const d=this.$loading.show();this.$http.get(`${M}/api/${g}/admin/orders?page=${e}`).then(n=>{const{pagination:h,orders:s}=n.data;this.orders=s,this.pagination=h,d.hide()}).catch(n=>{alert(n.response.data.message)})},updateOrder(e){this.$http.put(`${M}/api/${g}/admin/order/${e.id}`,{data:e}).then(d=>{alert(d.data.message),this.getOrders(),this.closeModal("modal")}).catch(d=>{alert(d.response.data.message)})},OpenModal(e,d){const n=this.$refs.orderModal,h=this.$refs.delOrderModal;e==="edit"?(this.tempOrder={...d},n.openModal()):e==="del"&&(this.tempOrder={...d},h.openModal())},closeModal(e){const d=this.$refs.orderModal,n=this.$refs.delOrderModal;e==="modal"?d.hideModal():e==="delModal"&&n.hideModal()}},mounted(){this.getOrders()}},ft={class:"container"},$t={class:"row py-3"},wt={class:"col-12"},Mt=t("h2",null,"訂單列表",-1),gt={class:"table table-hover mt-5"},yt=t("thead",null,[t("tr",null,[t("th",{width:"100"},"購買時間"),t("th",{width:"100"},"Email"),t("th",{width:"160"},"購買項目"),t("th",{width:"100"},"應付金額"),t("th",{width:"100"},"是否付款"),t("th",{width:"160"},"編輯")])],-1),vt={width:"100"},kt={width:"150"},Pt={width:"120"},Et={class:"list-unstyled"},xt={width:"120"},Ct={width:"100"},Dt={class:"form-check form-switch"},Vt=["id","onUpdate:modelValue","onChange"],Tt=["for"],It={width:"120"},At=["onClick"],Lt=["onClick"];function St(e,d,n,h,s,i){const _=b("PaginationComponent"),m=b("OrderModal"),u=b("DelOrderModal");return r(),c(p,null,[t("div",ft,[t("div",$t,[t("div",wt,[Mt,t("table",gt,[yt,t("tbody",null,[(r(!0),c(p,null,f(s.orders,a=>(r(),c("tr",{key:a.id},[t("td",vt,o(e.timeDate(a.create_at)),1),t("td",kt,o(a.user.email),1),t("td",Pt,[t("ul",Et,[(r(!0),c(p,null,f(a.products,l=>(r(),c("li",{key:l.id,class:"text-success mb-2"},o(l.product.title)+" 數量："+o(l.qty),1))),128))])]),t("td",xt,o(a.total),1),t("td",Ct,[t("div",Dt,[v(t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:`checkPaid${a.id}`,"onUpdate:modelValue":l=>a.is_paid=l,onChange:l=>i.updateOrder(a)},null,40,Vt),[[k,a.is_paid]]),t("label",{class:"form-check-label",for:`checkPaid${a.id}`},o(a.is_paid===!0?"已付款":"未付款"),9,Tt)])]),t("td",It,[t("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:l=>i.OpenModal("edit",a)}," 檢視 ",8,At),t("button",{type:"button",class:"btn btn-outline-danger",onClick:l=>i.OpenModal("del",a)}," 刪除 ",8,Lt)])]))),128))])]),O(_,{pages:s.pagination,onEmitPages:i.getOrders},null,8,["pages","onEmitPages"])])])]),O(m,{ref:"orderModal",order:s.tempOrder,onUpdatePaid:i.updateOrder},null,8,["order","onUpdatePaid"]),O(u,{order:s.tempOrder,onGetOrders:i.getOrders,onCloseModal:i.closeModal,ref:"delOrderModal"},null,8,["order","onGetOrders","onCloseModal"])],64)}const Bt=$(Ot,[["render",St]]);export{Bt as default};
